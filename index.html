<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Giffer</title>
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
        <link rel="stylesheet" href="css/style.css">
        <script src="https://bundle.run/pixelmatch@5.2.0"></script>
        <!--script src="CCapture.all.min.js"></script-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js" integrity="sha512-nNOFtIS+H0lwgdUDaPn/g1ssw3uN9AkEM7zy2wLaTQeLQNeNiitUcLpEpDIh3Z4T22MdeTNru/SQbNM4ig2rng==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    </head>
    <body>
        <!--video id="video" crossorigin="anonymous" src="https://upload.wikimedia.org/wikipedia/commons/a/a4/BBH_gravitational_lensing_of_gw150914.webm" controls width="500px"></video-->
        <!--video id="video" crossorigin="anonymous" src="https://upload.wikimedia.org/wikipedia/commons/transcoded/4/47/Sprengung_Bonn-Center.webm/Sprengung_Bonn-Center.webm.480p.vp9.webm" controls></video-->
        <div class="w3-container w3-blue-gray w3-xxlarge w3-center"><b>Giffer</b></div>
        <div class="w3-panel w3-orange w3-display-container w3-padding-16 w3-center">
            <span onclick="this.parentElement.style.display='none'" class="w3-button w3-orange w3-large w3-display-topright">X</span>
            Welcome to Giffer!<br>
            This website allows to create a new loop GIF (up to 100 frame). Input a video, set the starting frame, the end frame and the framerate and the page will generate a new GIF file.<br>
            It's recommended to visit this website with a PC to have a smaller wait time.<br>
            <br>
            <span class="w3-red w3-padding-4">Important: this page is functional only in Firefox, and the flag privacy.resistFingerprinting.autoDeclineNoUserInputCanvasPrompts in about:config must be OFF.</span><br>
            Remember to turn on again the flag after using this page, it's important for your own privacy.<br>
            The code is open source, if you want, you can take a look at the GitHub repo: <br>
        </div>
        <div id="firstStep" class="w3-panel w3-light-blue w3-center">
            <div id="firstStepExplanation" class="w3-container w3-indigo">
                <span class="w3-xlarge"><b>Step 1</b></span><br>
                Insert the video here.<br> 
                It's recommended to NOT insert very long videos or ultra high resolutions videos (for example 2K or 4K), otherwise the time needed for the operation will be longer than usual.
            </div>
            <input type="file" id="videoUpload" class="w3-input w3-indigo">
        </div>
        <div id="secondStep" class="w3-panel w3-cyan w3-center">
            <div id="secondStepExplanation" class="w3-container w3-indigo">
                <span class="w3-xlarge"><b>Step 2</b></span><br>
                Set the video to the starting frame of the GIF.
            </div>
            <video id="video" controls>No video</video>
            <canvas id="frame"></canvas>
            <button id="searchFrames" class="w3-button w3-indigo" disabled>Search frames</button>
        </div>
        <div id="thirdStep" class="w3-panel w3-blue w3-center">
            <div id="thirdStepExplanation" class="w3-container w3-indigo">
                <span class="w3-xlarge"><b>Step 3</b></span><br>
                Now there's a list of suggested frames to set as the last frame of the GIF.<br>
                "value" is the difference in pixels between the starting frame and a particular frame, usually the lower the better.<br>
                Input the last frame number and the framerate of the original video (by default it's 24 FPS)<br>
                Lastly, click "Create GIF" and a new page will show up with the newly created GIF.
            </div>
            <div id="frameSuggestionsContainer">
                <table id="frameSuggestions">
                    <tr>
                        <th>Frame</th>
                        <th>Difference value</th>
                    </tr>
                </table>
            </div>
            <input type="text" id="inputFrame" class="w3-input" placeholder="Insert the end frame">
            <input type="text" id="inputFPS" class="w3-input" placeholder="Insert FPS of the video (default 24)">
            <div id="qualitySliderContainer">
                <span>This slider represents the quality of the final GIF, the lower the better</span><br>
                <input type="range" id="qualitySlider" min="1" max="30">
                <span id="qualitySliderValue"></span>
            </div>
            <button id="createGif" class="w3-button w3-indigo">Create GIF</button>
            <script src="js/videoFrames.js"></script>
        </div>
        <div id="loadingScreen">
            <div id="loadingMessageContainer">
                <div id="loadingMessage">Loading ...</div>
            </div>
        </div>
    </body>
</html>